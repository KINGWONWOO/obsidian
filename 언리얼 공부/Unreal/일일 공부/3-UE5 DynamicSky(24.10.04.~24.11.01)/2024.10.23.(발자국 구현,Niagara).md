#### Unreal Engine 5 : 강의 하나로 DynamicSky 시스템 완벽 마스터하기!

##### 82강 : Anim 알림
- Footprint 구현을 위해 필요한 3가지
	- Anim Notify(이번 강의에서 알아볼 것!)
	- Decal Material
	- Niagara System
- Anim Notify 
	- 애니메이션 알림으로 애니메이션 시퀀스 중 특정 지점에서 이벤트를 트리거
	- 이를 통해 Pawn 애니메이션중 발이 바닥에 닿을 때 외부 동작(발바닥 생성)을 수행하도록 구현
- Pawn 구현 기준은 아래와 같다
![[Pasted image 20241023211826.png]]
- 오류 발생! : 게임 플레이 누를 시 Snowy가 적용되지 않는 상황 -> 매개 변수 컬렉션을 Construction Script 내에서만 설정했기 때문 -> Event Graph의 Begin Play에 Handle Weather 함수 연결
![[Pasted image 20241023211934.png]]
- AnimNotify 생성(Blueprint Class 생성 -> AnimNotify를 parent로 설정)
![[Pasted image 20241023212941.png]]
- Recieived Notify Function 생성
![[Pasted image 20241023213031.png]]
- 해당 애니메이션 이동 후 트랙에서 Notify 추가
![[Pasted image 20241023213111.png]]
- 해당 트랙 우클릭 후 Add Notify로 생성한 AnimNotify 추가
![[Pasted image 20241023213139.png]]
- 나중에 충돌 방지를 위해 AnimNotify Blueprint -> Class Default -> Show Fire in Editor 비활성화

##### 83강 : 블루프린트 매크로 라이브러리
- Footprint 구현에 필요한 3가지 구현
	- Spawn Limitation : Snowy에서만 나오게
	- Detect Surface : 표면 감지
	- Left/Right Foot : 어느 발인지
- 날씨 인식을 위해 AN_SpawnFootprint안에도 Macro를 만들고 싶으나 불가능 -> 그러나 For each, Branch와 같은 기존의 Macro는 사용가능
- 뭐가 다를까? -> 이 둘은 표준 블루프린트 매크로 라이브러리에 속함 -> 아 그럼 내가 블루프린트 매크로 라이브러리를 만들어서 거기에 사용하고자 하는 매크로를 넣자\
- NM_NotifyMacroLibrary 생성(Parent는 AnimNotify로 어디에 노출할지 설정)
![[Pasted image 20241023214836.png]]
![[Pasted image 20241023214931.png]]
- NM_NotifyMacroLibrary 안에 IsSunny 매크로 추가
![[Pasted image 20241023215046.png]]
- AN_SpawnFootprint에 IsSunny 호출
![[Pasted image 20241023220744.png]]
- 왼발, 오른발 처리를 위한 Enum 생성
![[Pasted image 20241023220934.png]]
- Enum과 Local Variable을 통해 오른발/왼발 변화 처리 진행
- 이때 Local Variable을 쓰는 이유는 해당 Recived_Notify Function이 const이기 때문에 Set을 쓸려면 Local 변수를 사용해야함
- Local 변수는 눈 모양을 눌러서 detail 패널에 보이게 한 뒤 사용할 애니메이션에서 설정
![[Pasted image 20241023221019.png]]
![[Pasted image 20241023221057.png]]
![[Pasted image 20241023221406.png]]
- LineTrace for Object를 이용해서 바닥을 탐지(아래는 전체 함수)
![[Pasted image 20241023221128.png]]
- 이때 Debug Type을 통해 작동 확인
- 마무리로 애니메이션에서 해당 Notify 채우기
![[Pasted image 20241023221226.png]]

##### 84강 : 데칼 머터리얼
- decal : Mesh에 투영되는 Materials
- decal Material 생성 : Material 생성 후 Mode 변경
![[Pasted image 20241023222137.png]]
- decal Material 늘어짐 현상 제거법 : 기존의 Triplanar 기법 사용
- 이때 World Spcae Normal 입력 핀에 기존의 VertexNormalWS가 아닌 SceneTexture:WorldNormal이 연결된 것에 주의
![[Pasted image 20241023222357.png]]

##### 85강 : 나이아가라 리프레셔
- Niagar의 중요 내용
	- Renderers
	- Module/Stages
	- VFX Material
	- Parameter Map
- Renderers
	- 이 강의에서는 2가지의 렌더러 사용
	- Sprite Renderer : 카메라를 향하는 2d 평면 렌더링, 아무리 회전해도 정면이 보임
	- Decal Renderer : Decal을 직접 렌더링
- Module/Stages
	- Module은 블루프린트 함수와 매우 유사 
	- Niagara 작업 시 Stage 아래에서 작업
	- Stage의 종류는 많지만, 모두 Spawn과 Update 유형으로 분류 가능
	- Spawn Stage에 배치된 모든 Niagara Module은 한 번 실행
	- Update Stage에 배치된 모든 Niagara Module은 매 프레임 실행
	- Blueprint의 BeginPlay와 Tick과 유사
- VFX Material
	- VFX Material을 만들 때 주로 두 가지 블렌드 모드를 사용
	- Additive(밝음)/Translucent(어두움)
	- 주로 사용하는 Node는 Particle Color로 이를 통해 Niagara에서 직접 색상과 불투명도를 가져올 수 있음
- Parameter Map
	- Niagara에 배치하는 모든 Module은 기본적으로 Niagara Parameter Map 내의 매개변수에 값을 씀
- 예시
	- VFX Material 생성 및 Mode 변경
	![[Pasted image 20241023223634.png]]
	- VFX Material 노드 간단하게 구현 및 연결
	![[Pasted image 20241023223740.png]]
	- Niagara 생성 후 VFX 연결
	![[Pasted image 20241023224155.png]]
	