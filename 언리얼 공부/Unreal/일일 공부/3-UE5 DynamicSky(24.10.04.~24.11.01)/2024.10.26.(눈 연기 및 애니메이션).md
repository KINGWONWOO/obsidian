#### Unreal Engine 5 : 강의 하나로 DynamicSky 시스템 완벽 마스터하기!

##### 91강 : 눈 연기 입자
- Snow Smoke를 위한 M_SnowSmokeMaster_Additive 머터리얼 생성
- 이때 Blend Mode : Additive/ Shading Model : Unlit으로 설정
- Depth Fade는 Particle과 바닥간의 경계가 생기는 현상을 없애기 위해 연결
- Dynamic Parameter는 Niagara System과 Material간의 변수 공유를 위해 생성
- SmokeEdgeSoftnessAmout가 1일 시 Particle Size의 10%를 Depth Fade의 Fade Distance로 설정 10일 시는 그대로 사용
 ![[Pasted image 20241026143158.png]]
 - NS_SnowStorm에 SnowSmoke Emitter 추가(parent는 simple burst sprite)
 - Sprite Renderer에서 base material 변경
 - Sprite Renderer에서 Sub Uv/Sub Image Size 8-8로 변경
 - Sub UVAnimation 추가, Sprite Renderer로 설정
 - Spawn Rate로 교환,  Random Range Float로 1-4로 설정
 - Initialize Particle로 Size 키우기(3000)
 - Dynamic Material Parameters 추가
 - SmokeEdgeSoftnessAmout는 Random Range Float로 4-6으로 설정
 - 그 외 다양성을 주기 위해 크기, 사이즈, WInd 등에 random range 적용
 - Scale Color에서 FadeCurve는 Snow_Base와 같게 설정
 ![[Pasted image 20241026144519.png]]
##### 92강 : 나이아가라 시스템 구성 요소 토글
- DA_Snowy일 때만 SnowStorm이 작동하도록 하고 싶음 -> BP_DynamicSky에서 설정
- 새로운 Component인 Niagara Particle System Component 추가 후 NS_SnowStorm 할당, Auto Active는 비활성화
![[Pasted image 20241026150119.png]]
- 새로운 Macro 'ToggleNiagaraSystemComponent'생성해서 해당 Component의 Auto Active 조작
![[Pasted image 20241026150200.png]]
- 해당 Macro를 사용해서 Snowy일때만 SnowStorm이 작동하도록 설정(Toggle Snow에서 설정)
![[Pasted image 20241026150237.png]]

##### 93강 : 섹션 과제 - 사용자 매개변수
- Niagara System의 속성 값을 Blueprint에서 쓰기 위해 User Parameter 사용
- 원하는 속성 값에 'Read from new User parameter' 사용해서 User Parameter로 만들기
![[Pasted image 20241026192628.png]]
![[Pasted image 20241026192656.png]]
- Detail 창 커스터마이징 위해 User Parameter를 저장할 Struct 생성 : 안해도 됨. 드롭다운 형식으로 만들기 위한 선택사항
![[Pasted image 20241026192752.png]]
- BP_DynamicSky에서 해당 Struct를 변수형태로 갖는 변수 생성, 눈 모양 클릭
![[Pasted image 20241026192828.png]]
- 'Set Snow Particle Settings' 이름의 Macro 생성 후 Struct를 이용해서 Niagara System 내의 User Parameter 설정
![[Pasted image 20241026192925.png]]
- Detail 창에서 동작 확인
![[Pasted image 20241026192959.png]]

##### 94강 : 눈 커버리지 애니메이션
- 눈이 점차 쌓이는 애니메이션 효과 넣어주기 : Lerp 노드 활용
- MF_SnowyWeatherBlend에서 Blend 부분 수정
![[Pasted image 20241026193954.png]]
- Viewport에서 Actor 클릭 시 BP_DynamicSky만 선택 됨 
	- 이유 : Particle이 퍼져 있기 때문
	- 해결 : 반투명 선택 비활성화하기(키보드 T)
- 이제 BP_DynamicSky에서 시간에 따라 Is_Snowing 변하게 하기(Struct에 변수 2개 추가)
- 시작 시 Snowy 상태 확인 및 Snow Animation 활성화 확인(확인 후 Is_Snowing을 0으로 초기화)
![[Pasted image 20241026200733.png]]
- 1.5초의 딜레이 후 Set Play Rate로 진행 시간 설정/ Timeline으로 Is_Snowing의 값을 0~1로 천천히 변경 후 적용
![[Pasted image 20241026200903.png]]
- Timeline은 다음과 같이 설정(이때, F 클릭 시 확대, 1 클릭 시 스무스화)
 ![[Pasted image 20241026200917.png]]

##### 95강 : 기본값 동기화
- 언제나 Macro, Variable등 카테고리화 일상화
![[Pasted image 20241026201538.png]]
- 블루프린트를 ViewPort에 드롭다운한 후 다양한 값을 변경했다면 Blueprint와 다시 동기화 필요. 안그럴시 삭제 후 다시 드롭다운하면 블루프린트 기준 기본값으로 초기화됨.

##### 96강 : 눈 애니메이션 조정하기
- 눈 애니메이션에서 발생하는 추가 문제점 해결
1. Snowy Animation을 사용하지 않는 경우 Delay 시간 후 갑자기 눈이 생기는 문제
	- 원인 : Is_Snowing을 0~1로 바꾸는 과정이 애니메이션을 껐을 때도 적용되어  0에서 0.0001로 바뀔 때 If문에 의해 갑자기 눈이 생김
	- 해결 : 애니메이션 유무에 따라 사용하는 변수를 분리(SnowAmount 변수 생성 후 애니메이션의 Is_Snowing을 대체)
	- 과정 : 
		1. MPC_WeatherProperties에 새 변수인 SnowAmount 추가
		2. MF_SnowyWeatherBlend에 SnowAmount 대체
		 ![[Pasted image 20241026202531.png]]
		 3. BP_DynamicSky에서 Toggle Snow와 Event Graph에서 SnowAmount 항목 추가 및 대체
		 ![[Pasted image 20241026202649.png]]
		 ![[Pasted image 20241026202741.png]]
2. 눈이 내릴 시 바닥에 눈이 너무 골고루 쌓이는 문제
	- 원인 : 눈이 쌓이는 표면에 무작위성이 없어서 갑자기 여러 개의 눈 입자가 화면에 등장 
	- 해결 : 머터리얼 함수를 수정해서 무작위성 추가 그 과정에서 타일링 이슈도 해결
	- 과정 : 