#### Unreal Engine 5 C++ 개발자  
##### 195강
- 게임 종료 및 재시작등은 PlayerController에서 정의 이후 이를 Gamemode에 연결하여 실행 
- GameHasEnded() : PlayerController.h에 정의된 게임 종료를 알리기 위한 함수
- 입력
	- class AActor * EndGameFocus : 종료 후 뷰타겟(기본값 : nullptr)
	- bool bIsWinner : 성공이냐 실패냐 결과(기본값 : false)
```C++
APlayerController* PlayerController = Cast<APlayerController>(PawnKilled->GetController());
if (PlayerController != nullptr)
{
    PlayerController->GameHasEnded(nullptr, false);
}
```
- 게임 재시작도 내장된 함수를 통해 진행
```C++
GetWorldTimerManager().SetTimer(
	RestartTimer, 
	this, 
	&APlayerController::RestartLevel, 
	RestartDelay
);
```

##### 196강
- Widget_Blueprint에서 요소들 이동 시 Shift누르면 축에 고정된채로 이
- Widget 생성 후 추가하는 코드
```C++
//ShooterPlayerContorller.h | private
UPROPERTY(EditAnywhere)
TSubclassOf<class UUserWidget> LoseScreenClass;
//ShooterPlayerContorller.cpp | GameHasEnded()
UUserWidget* LoseScreen = CreateWidget(this, LoseScreenClass);
if (LoseScreen != nullptr)
{
    LoseScreen->AddToViewport();
}
```

##### 197강
- TActorRange<>()를 통해 월드 내 특정 클래스의 액터들을 모두 불러올 수 있음.
- 사용 예시
```C++
for (AController* Controller : TActorRange<AController>(GetWorld()))
{
    bool bIsWinner = Controller->IsPlayerController() == bIsPlayerWinner;
    Controller->GameHasEnded(Controller->GetPawn(), bIsWinner);
}
```

##### 199강
- Refactoring 예시
- 원본
![[Pasted image 20240802211648.png]]
- 수정
```C++
void AGun::PullTrigger()
{
    UGameplayStatics::SpawnEmitterAttached(MuzzleFlash, Mesh,TEXT("MuzzleFlashSocket"));
    FHitResult Hit;
    FVector ShotDirection;
    bool bSuccess = GunTrace(Hit, ShotDirection);
    if (bSuccess)
    {
        UGameplayStatics::SpawnEmitterAtLocation(GetWorld(), ImpactEffect, Hit.Location, ShotDirection.Rotation());
        AActor* HitActor = Hit.GetActor();
        if (HitActor != nullptr)
        {
            FPointDamageEvent DamageEvent(Damage, Hit, ShotDirection, nullptr);
            AController *OwnerController = GetOwnerController();
            HitActor->TakeDamage(Damage, DamageEvent, OwnerController, this);
        }
    }
}
```

```C++
bool AGun::GunTrace(FHitResult &Hit, FVector& ShotDirection)
{
    AController *OwnerController = GetOwnerController();
    if (OwnerController == nullptr)
        return false;
    FVector Location;
    FRotator Rotation;
    OwnerController->GetPlayerViewPoint(Location, Rotation);
    //타입명을 입력하면 지역변수가 되므로 제
    ShotDirection = -Rotation.Vector();

    FVector End = Location + Rotation.Vector() * MaxRange;
    FCollisionQueryParams Params;
    Params.AddIgnoredActor(this);
    Params.AddIgnoredActor(GetOwner());
    return GetWorld()->LineTraceSingleByChannel(Hit, Location, End, ECollisionChannel::ECC_GameTraceChannel1, Params);
}
```

```C++
AController* AGun::GetOwnerController() const
{
    APawn *OwnerPawn = Cast<APawn>(GetOwner());
    if (OwnerPawn == nullptr)
        return nullptr;
    return OwnerPawn->GetController();
}
```

##### 201강
- 사운드를 더 풍부하게 하기 위해 Sound_Cue 사용 가능
![[Pasted image 20240802213336.png]]
- Random : 입력 핀의 사운드를 랜덤하게 하나 골라 재생(Detail에서 비복원/복원 설정 가능)
- Modulator : Pitch와 Volume을 랜덤하게 설정해 재생
- 여러 오디오를 한 번에 불러올 때는 Editor의 Content browser에서 다중 선택 후 Cue에서 우클릭 시 간단하게 불러오기 가능

##### 202강
- 사운드를 공간화(거리에 따른 감쇠, 좌우 스테레오 음향)을 위해서는 어테뉴에이션 설정
- Cue의 Detail 패널에서 설정 가능
![[Pasted image 20240802220547.png]]
